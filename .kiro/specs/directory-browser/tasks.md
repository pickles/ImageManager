# 実装計画

- [x] 1. 基本的なプロジェクト構造とインターフェースの設定





  - 新しいコンポーネント用のディレクトリ構造を作成
  - TypeScript型定義ファイルを作成（DirectoryBrowser関連の型）
  - 基本的なインターフェースとenumを定義（SortOption, SortOrder含む）
  - _要件: 1.1, 2.1, 6.1_

- [x] 2. DirectoryService の実装





  - IDirectoryService インターフェースを定義
  - DirectoryService クラスの基本実装を作成
  - ディレクトリ選択機能の実装（File System Access API使用）
  - 画像ファイル検索機能の実装
  - DirectoryService の単体テストを作成
  - _要件: 1.3, 2.1, 2.2, 2.3_

- [x] 3. CollapsiblePanel 汎用コンポーネントの実装





  - CollapsiblePanel コンポーネントの基本構造を作成
  - 折りたたみ/展開アニメーションの実装
  - アクセシビリティ対応（ARIA属性、キーボードナビゲーション）
  - CollapsiblePanel のスタイリング（CSS）
  - CollapsiblePanel の単体テストを作成
  - _要件: 4.1, 4.2, 4.5, 4.6, 5.5_

- [ ] 4. DirectorySelector コンポーネントの実装
  - DirectorySelector コンポーネントの基本構造を作成
  - ディレクトリ選択ボタンの実装
  - 選択されたディレクトリパスの表示機能
  - エラーハンドリング（権限エラー、ブラウザサポートエラー）
  - DirectorySelector のスタイリング（CSS）
  - DirectorySelector の単体テストを作成
  - _要件: 1.1, 1.3, 1.4_

- [ ] 5. ImageFileList コンポーネントの実装
  - ImageFileList コンポーネントの基本構造を作成
  - ファイル一覧表示機能の実装（ファイル名と作成日表示）
  - ソート機能の実装（ファイル名、作成日の昇順・降順）
  - ソートUI（ヘッダーボタン）とソート状態の視覚的表示
  - デフォルトソート（作成日降順）の実装
  - ファイル選択状態の視覚的表示
  - スクロール可能な一覧表示の実装
  - ローディング・エラー状態の表示
  - ImageFileList のスタイリング（CSS）
  - ImageFileList の単体テストを作成（ソート機能含む）
  - _要件: 2.2, 2.4, 2.5, 2.7, 3.1, 3.2, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_

- [ ] 6. DirectoryBrowser メインコンテナの実装
  - DirectoryBrowser コンポーネントの基本構造を作成
  - 状態管理の実装（selectedDirectory, imageFiles, isLoading, error, sortBy, sortOrder）
  - ソート状態管理とファイル一覧のソート処理
  - 子コンポーネント間の連携ロジック
  - ファイル選択イベントの処理
  - DirectoryBrowser のスタイリング（CSS）
  - DirectoryBrowser の単体テストを作成（ソート機能含む）
  - _要件: 1.1, 2.1, 2.5, 3.1, 3.3, 3.4, 4.1, 6.5_

- [ ] 7. レスポンシブデザインの実装
  - CSS Grid レイアウトの実装
  - モバイル用オーバーレイ表示の実装
  - タブレット・デスクトップ用固定表示の実装
  - ブレークポイント別のスタイリング
  - レスポンシブ動作のテスト作成
  - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 8. App.tsx との統合
  - App.tsx にDirectoryBrowser の状態管理を追加
  - 既存のhandleFileSelect との統合
  - CSS Grid レイアウトの適用
  - 左ペインの折りたたみ状態管理
  - 統合後の動作テスト作成
  - _要件: 1.1, 3.3, 3.4, 4.1, 4.2, 4.5, 4.6_

- [ ] 9. エラーハンドリングの強化
  - DirectoryBrowserErrorType enum の実装
  - エラー表示コンポーネントの作成
  - 各コンポーネントでのエラーハンドリング強化
  - フォールバック機能（従来のファイル選択）の実装
  - エラーシナリオのテスト作成
  - _要件: 1.4, 2.6, 3.5_

- [ ] 10. パフォーマンス最適化
  - React.memo を使用したコンポーネントのメモ化
  - useMemo、useCallback を使用した不要な再計算の防止
  - 大量ファイル対応（仮想スクロールの基本実装）
  - メモリリーク防止（ファイルオブジェクトの適切な解放）
  - パフォーマンステストの作成
  - _要件: 2.5, 3.6_

- [ ] 11. アクセシビリティの実装
  - ARIA属性の追加（role, aria-label, aria-expanded等）
  - キーボードナビゲーションの実装
  - フォーカス管理の実装
  - スクリーンリーダー対応の確認
  - アクセシビリティテストの作成
  - _要件: 5.5_

- [ ] 12. 統合テストとE2Eテストの実装
  - ディレクトリ選択からファイル表示までの統合テスト
  - 折りたたみ機能の統合テスト
  - レスポンシブ動作の統合テスト
  - エラーシナリオの統合テスト
  - E2Eテストの実装（完全なワークフロー）
  - _要件: 1.1, 1.3, 2.1, 2.2, 3.1, 3.3, 4.1, 4.2, 5.1_

- [ ] 13. 最終的な統合とポリッシュ
  - 全コンポーネントの最終統合
  - スタイリングの調整と統一
  - パフォーマンスの最終チェック
  - ブラウザ互換性の確認
  - ドキュメントの更新（README、コメント）
  - _要件: 全要件の最終確認_